{
  "name": "diagramflow-vscode-extension",
  "displayName": "DiagramFlow",
  "description": "Bidirectional visual diagram editor for VS Code with native GitHub Copilot integration",
  "version": "0.1.0",
  "license": "Apache-2.0",
  "publisher": "diagramflow",
  "main": "dist/extension.js",
  "types": "dist/extension.d.ts",
  "scripts": {
    "build": "npm run check-types && node esbuild.config.mjs",
    "build:watch": "node esbuild.config.mjs --watch",
    "check-types": "tsc --noEmit",
    "package": "npm run build && vsce package --no-dependencies",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:coverage": "vitest run --coverage"
  },
  "devDependencies": {
    "@dagrejs/dagre": "^1.1.4",
    "@types/react": "^19.2.14",
    "@types/react-dom": "^19.2.3",
    "@types/vscode": "^1.103.0",
    "@vitest/coverage-v8": "^3.2.4",
    "@vscode/vsce": "^3.0.0",
    "esbuild": "^0.24.0",
    "nanoid": "^5.0.9"
  },
  "engines": {
    "vscode": ">=1.103.0"
  },
  "categories": [
    "Visualization",
    "Other"
  ],
  "activationEvents": [
    "onCustomEditor:diagramflow.editor"
  ],
  "contributes": {
    "commands": [
      {
        "command": "diagramflow.newDiagram",
        "title": "DiagramFlow: New Diagram"
      },
      {
        "command": "diagramflow.autoLayout",
        "title": "DiagramFlow: Auto Layout"
      },
      {
        "command": "diagramflow.sortNodes",
        "title": "DiagramFlow: Sort Nodes"
      }
    ],
    "customEditors": [
      {
        "viewType": "diagramflow.editor",
        "displayName": "Diagram Editor",
        "selector": [
          {
            "filenamePattern": "*.diagram.svg"
          },
          {
            "filenamePattern": "*.diagram"
          }
        ],
        "priority": "default"
      }
    ],
    "languages": [
      {
        "id": "diagram",
        "extensions": [
          ".diagram"
        ],
        "aliases": [
          "Diagram"
        ]
      },
      {
        "id": "diagram-svg",
        "extensions": [
          ".diagram.svg"
        ],
        "aliases": [
          "Diagram SVG"
        ]
      }
    ],
    "languageModelTools": [
      {
        "name": "diagramflow_readDiagram",
        "tags": [
          "diagram",
          "diagramflow",
          "visualization"
        ],
        "toolReferenceName": "readDiagram",
        "displayName": "Read Diagram",
        "modelDescription": "Reads a .diagram file and returns a plain-text architecture description optimised for LLM comprehension. No coordinates or opaque IDs — just semantic content. Use this to understand and reason about a diagram. Use diagramflow_getDiagram when you need IDs to update the diagram. `filePath` is required — always specify the absolute path to the .diagram file.",
        "userDescription": "Read a diagram's architecture as human-readable text.",
        "canBeReferencedInPrompt": true,
        "icon": "$(book)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to read."
            }
          }
        }
      },
      {
        "name": "diagramflow_getDiagram",
        "tags": [
          "diagram",
          "diagramflow",
          "visualization"
        ],
        "toolReferenceName": "getDiagram",
        "displayName": "Get Diagram",
        "modelDescription": "Reads a .diagram file and returns its full JSON representation including all nodes (with id, label, shape, color, position, pinned status), edges (with id, source, target, label, style), and groups. Use this to understand the current state of a diagram before making modifications. `filePath` is required — always specify the absolute path to the .diagram file.",
        "userDescription": "Read a diagram's nodes, edges, and layout.",
        "canBeReferencedInPrompt": true,
        "icon": "$(eye)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to read."
            }
          }
        }
      },
      {
        "name": "diagramflow_addNodes",
        "tags": [
          "diagram",
          "diagramflow"
        ],
        "toolReferenceName": "addNodes",
        "displayName": "Add Diagram Nodes",
        "modelDescription": "Adds one or more nodes to the .diagram file at `filePath`. Each node requires a label and optionally accepts shape, color, notes, and group. Nodes are auto-positioned by the layout engine — do NOT specify x, y, or id. If the diagram is open in the editor, changes appear in real time. `filePath` is required.",
        "userDescription": "Add new nodes to the diagram.",
        "canBeReferencedInPrompt": true,
        "icon": "$(add)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "nodes"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "nodes": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["label"],
                "properties": {
                  "label": { "type": "string" },
                  "shape": {
                    "type": "string",
                    "enum": ["rectangle", "rounded", "diamond", "cylinder"]
                  },
                  "color": {
                    "type": "string",
                    "enum": ["default", "blue", "green", "red", "yellow", "purple", "gray"]
                  },
                  "notes": { "type": "string" },
                  "group": { "type": "string" }
                }
              }
            }
          }
        }
      },
      {
        "name": "diagramflow_removeNodes",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "removeNodes",
        "displayName": "Remove Diagram Nodes",
        "modelDescription": "Removes one or more nodes from the .diagram file at `filePath` by their ids. Also removes all connected edges. Use diagramflow_getDiagram first to find node ids. `filePath` is required.",
        "userDescription": "Remove nodes from the diagram by id.",
        "canBeReferencedInPrompt": true,
        "icon": "$(trash)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "nodeIds"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "nodeIds": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        }
      },
      {
        "name": "diagramflow_updateNodes",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "updateNodes",
        "displayName": "Update Diagram Nodes",
        "modelDescription": "Updates properties of existing nodes in the .diagram file at `filePath`. Each update requires the node id. Updatable: label, shape, color, notes, group. `filePath` is required.",
        "userDescription": "Update properties of existing diagram nodes.",
        "canBeReferencedInPrompt": true,
        "icon": "$(edit)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "updates"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "updates": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["id"],
                "properties": {
                  "id": { "type": "string" },
                  "label": { "type": "string" },
                  "shape": {
                    "type": "string",
                    "enum": ["rectangle", "rounded", "diamond", "cylinder"]
                  },
                  "color": {
                    "type": "string",
                    "enum": ["default", "blue", "green", "red", "yellow", "purple", "gray"]
                  },
                  "notes": { "type": "string" },
                  "group": { "type": "string" }
                }
              }
            }
          }
        }
      },
      {
        "name": "diagramflow_addEdges",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "addEdges",
        "displayName": "Add Diagram Edges",
        "modelDescription": "Adds edges between existing nodes in the .diagram file at `filePath`. Each edge requires source and target node ids. Optional: label, style, arrow, animated. `filePath` is required.",
        "userDescription": "Add edges between diagram nodes.",
        "canBeReferencedInPrompt": true,
        "icon": "$(git-merge)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "edges"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "edges": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["source", "target"],
                "properties": {
                  "source": { "type": "string" },
                  "target": { "type": "string" },
                  "label": { "type": "string" },
                  "style": {
                    "type": "string",
                    "enum": ["solid", "dashed", "dotted"]
                  },
                  "arrow": {
                    "type": "string",
                    "enum": ["arrow", "open", "none"]
                  },
                  "animated": { "type": "boolean" }
                }
              }
            }
          }
        }
      },
      {
        "name": "diagramflow_removeEdges",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "removeEdges",
        "displayName": "Remove Diagram Edges",
        "modelDescription": "Removes edges by their ids from the .diagram file at `filePath`. Use diagramflow_getDiagram first to find edge ids. `filePath` is required.",
        "userDescription": "Remove edges from the diagram by id.",
        "canBeReferencedInPrompt": true,
        "icon": "$(trash)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "edgeIds"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "edgeIds": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        }
      },
      {
        "name": "diagramflow_updateEdges",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "updateEdges",
        "displayName": "Update Diagram Edges",
        "modelDescription": "Updates properties of existing edges in the .diagram file at `filePath`. Each update requires the edge id. Updatable: label, style, arrow, animated, source, target. `filePath` is required.",
        "userDescription": "Update properties of existing diagram edges.",
        "canBeReferencedInPrompt": true,
        "icon": "$(edit)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "updates"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "updates": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["id"],
                "properties": {
                  "id": { "type": "string" },
                  "label": { "type": "string" },
                  "style": {
                    "type": "string",
                    "enum": ["solid", "dashed", "dotted"]
                  },
                  "arrow": {
                    "type": "string",
                    "enum": ["arrow", "open", "none"]
                  },
                  "animated": { "type": "boolean" },
                  "source": { "type": "string" },
                  "target": { "type": "string" }
                }
              }
            }
          }
        }
      },
      {
        "name": "diagramflow_addGroups",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "addGroups",
        "displayName": "Add Diagram Groups",
        "modelDescription": "Adds one or more groups to the .diagram file at `filePath`. Groups are visual containers that organise related nodes. Each group requires a label and optionally accepts color. After adding a group, assign nodes to it by updating their group field with diagramflow_updateNodes. `filePath` is required.",
        "userDescription": "Add groups to the diagram to organise nodes visually.",
        "canBeReferencedInPrompt": true,
        "icon": "$(symbol-namespace)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "groups"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "groups": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["label"],
                "properties": {
                  "label": {
                    "type": "string",
                    "description": "Display name of the group"
                  },
                  "color": {
                    "type": "string",
                    "enum": ["default", "blue", "green", "red", "yellow", "purple", "gray"]
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "diagramflow_removeGroups",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "removeGroups",
        "displayName": "Remove Diagram Groups",
        "modelDescription": "Removes one or more groups from the .diagram file at `filePath` by their IDs. Child nodes are retained but detached from the group. `filePath` is required.",
        "userDescription": "Remove groups from the diagram.",
        "canBeReferencedInPrompt": true,
        "icon": "$(trash)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "groupIds"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "groupIds": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        }
      },
      {
        "name": "diagramflow_updateGroups",
        "tags": ["diagram", "diagramflow"],
        "toolReferenceName": "updateGroups",
        "displayName": "Update Diagram Groups",
        "modelDescription": "Updates properties of existing groups in the .diagram file at `filePath`. Each update requires the group id. Updatable: label, color. `filePath` is required.",
        "userDescription": "Update properties of existing diagram groups.",
        "canBeReferencedInPrompt": true,
        "icon": "$(edit)",
        "inputSchema": {
          "type": "object",
          "required": ["filePath", "updates"],
          "properties": {
            "filePath": {
              "type": "string",
              "description": "Absolute path to the .diagram file to modify."
            },
            "updates": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["id"],
                "properties": {
                  "id": { "type": "string" },
                  "label": { "type": "string" },
                  "color": {
                    "type": "string",
                    "enum": ["default", "blue", "green", "red", "yellow", "purple", "gray"]
                  }
                }
              }
            }
          }
        }
      }
    ]
  },
  "dependencies": {
    "@xyflow/react": "^12.10.1",
    "react": "^19.2.4",
    "react-dom": "^19.2.4"
  }
}
